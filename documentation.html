<?php $pageTitle = "Documentation"; ?>
<div class="container">
	<div class="row row-offcanvas row-offcanvas-right">
		<div class="col-xs-12 col-sm-9">
			<style type="text/css">
				.highlight{
					background-color: #eeeeee;
					padding: 10px;
					display: inline-block;
				}
				.stuck{
					position: fixed;
					top: 10px;
				}

				td > p{
					margin: 10px;
				}

				/*view source */

				.docDiv{
					border-style: solid;
					border-width: 2px;
					margin: 5px;
					padding: 8px;
				}
			</style>
			<script type="text/html" id="docTemplate">
				<div class="docDiv">
					<div class="docSwitch">
						<button data-type="docExample">Example</button>
						<button data-type="docSource">Source</button>
					</div>

					<div class="doc docSource" style="display:none">
						<pre class="highlight">{{source}}</pre>
					</div>
				</div>
				<hr />
			</script>


			<h1 id="About">About</h1>
			<p>
				jq-reapt is a simple repeating templating tool. Is is modeled after ng-repeat and shares some basic syntax, but is not a clone.
			</p>
			<p>
				jq-repeat requires jQuery and Mustache to run.
			</p>

			<h1 id="Template">Template</h1>
			<p>
				To set up a repeat template, write any element tag you wish to repeat once where you want the repeating to start, this will serve as the template and starting point.<br />
				Simply add a jq-repeat attribute with a unique value for the reference name for that template, in this case myRepeat. To add variables place the name in double curly brackets {{ name }} .

				<pre class="highlight"><!--
			<p jq-repeat="myRepeat">
				{{ character }} in English {{spelling}}
			</p>-->
				</pre>
			</p>

			<h1 id="Insert">Insert</h1>
			<p>
				Now that you have a template set up, let's populate the template use $.scope.myRepeat.push()
			</p>

			<pre class="highlight">
			$.scope.myRepeat.push( { character: 1, spelling: 'one' } )
			</pre>

			<p>
				You can add any number of values as arguments you wish and each will create a new element from the template. Values must be supplied as objects with keys corresponding to the variable names used in the template.
			</p>

			<pre class="highlight">
			$.scope.myRepeat.push({
				character: 1,
				spelling: 'one'
			}, {
				character: 2,
				spelling: 'two'
			}, {
				character: 3,
				spelling: 'three'
			});
			</pre>

			<h1 id="Methods">Methods</h1>
			<p>
				The repeat object can take may methods used for array's and holds as an array of the objects being repeated.
				<ul>
					<li><b>$.scope.myRepeat.splice(index [, howMany] [,ToAdd])</b> functions exactly as a regular array with notable difference. If the index propriety is set a string can be passed as the value of the index.
						<ul>
							<li>
								<h3><i>index</i></h3>
								<b>Type: Number or String</b><br />
								Index of element you wish to manipulate. If the .index property is set, you may pass a string to match to the index array.
							</li>
							<li>
								<h3><i>howMany</i></h3>
								<b>Type: Number</b><br />
								Number of repeat objects that will be removed.<br />
								Of there are non to be removed, it is not required to use this argument. 
							</li>
							<li>
								<h3><i>update</i></h3>
								<b>Type: Array</b><br />
								This is the array of repeat objects to add.<br />
								If there are none to this is not required. 
							</li>
							<li>
								<h3><i>returns</i></h3>
								<b>Type: Array</b><br />
								This function will return an array of deleted elements.
							</li>
						</ul>
					</li>
					<li><b>$.scope.myRepeat.pop()</b> Will remove and return the last element in the repeat array</li>
					<li><b>$.scope.myRepeat.reverse()</b> Will reverse the repeat array by index number.<i>todo: if .index is a number, will use that.</i> Returns the newly formated array.</li>
					<li><b>$.scope.myRepeat.shift()</b> works the same as regular arrays.</li>
					<li><b>$.scope.myRepeat.loop()</b> will take the last value and insert in the front. .loopUp() does the opposite. Returns the newly formated array.</li>
					<li><b>$.scope.myRepeat.indexOf( key, value )</b> Returns the array index number of the matching element. Mostly used for internals.
						<ul>
							<li>
								<h3><i>key</i></h3>
								<b>Type: String</b><br />
								The key element to match.
							</li>
							<li>
								<h3><i>value</i></h3>
								<b>Type: String</b><br />
								The value of the matching element.
							</li>
						</ul>
					</li>
					<li><b>$.scope.myRepeat.update( [key,] value, update)</b> Updates selected value with new data. The selection process is done by matching key, value pairs from the existing objects,
						<ul>
							<li>
								<h3><i>key</i></h3>
								<b>Type: String</b><br />
								The key of the matching element to update. If no value is given the index will be used.
							</li>
							<li>
								<h3><i>value</i></h3>
								<b>Type: String</b><br />
								The value of the matching key to the element to be update.If the index key will be used, this can be the first argument.
							</li>
							<li>
								<h3><i>update</i></h3>
								<b>Type: Object</b><br />
								This is the object that will be applied to the matching element.
							</li>
						</ul>
					</li>
				</ul>

				<ul>
					<li><b>$.scope.myRepeat.__put</b> is the function that will run when a element is being inserted. This must be a function and must include this.show(), or some other way of un-hiding 'this'.</li>
					<li><b>$.scope.myRepeat.__take</b> is the function that will run when an element is being removes. This must be a function and include this.remove() or some other way to remove 'this'.</li>
					<li><b>$scope.myRepeat.__index</b> is the propriety that defines the object key to use an the index. If this is set, a string can be used inplace of a number for any index reference.</li>
				</ul>
			</p>

			<h1 id="Demo">Demo</h1>
			<div class="docExample">
				<table border="1px" style="padding:2px; margin:5px;">
					<tr>
						<td>
							<p jq-repeat="myRepeat">
								{{character}} in English {{spelling}} <button onclick="removeRepeat(this)">Remove</button>
							</p>
						</td>
						<td>
							<p>
								<button onclick="javascript:$.scope.myRepeat.loop()">Loop()</button><br />
								<button onclick="javascript:$.scope.myRepeat.loopUp()">LoopUp()</button><br />
								<button onclick="javascript:$.scope.myRepeat.reverse()">reverse()</button><br />
							</p>
						</td>
						<td>
							<p>
								<lable>character:</lable><br />
								<input type="text" id="character" /></br>
								<lable>spelling:</lable><br />
								<input type="test" id="spelling" /><br />
								<button onclick="addRepeat()">Add</button>
							</p>
						</td>
					</tr>
				</table>
				<script type="text/javascript">
				$( document ).ready(function(){
					$.scope.myRepeat.push(
						{character: 1, spelling: "one"}, 
						{character: 2, spelling: "two"}, 
						{character: 3, spelling: "three"}

					);

					var addRepeat = function(){
						$.scope.myRepeat.push({
							character: $( "#character" ).val(),
							spelling: $("#spelling").val()
						});
						return false;
					};

					var removeRepeat = function(btn){
						$.scope.myRepeat.splice( Number($(btn).parents('[jq-repeat-index]').attr('jq-repeat-index')), 1 );
					};
				});
				</script>
			</div>
		</div>

		<div class="col-xs-6 col-sm-3 nav bs-sidenav" id="sidebar" role="navigation">
			<div class="list-group">
				<a href="{{href}}" class="list-group-item" jq-repeat="sidebarList">{{name}}</a>
			</div>
		</div>
	</div>
</div>

<script src="js/php.js"></script>
<script type="text/javascript">


$( document ).ready( function () {

	//hide source from HTML rendering
	$( ".highlight" ).each ( function(){
		var html = $(this).html();
		html = html.replace("<!--", "");
		html = html.replace("-->", "");
		html = htmlspecialchars( html );
		$( this ).html( html );
	} );

	$.SyntaxHighlighter.init();
	var sideWidth;
	//build side nav bar
	$( "h1, h2, h3, h4" ).each( function () {
		if( $( this ).is( '[id]' ) ){
			test = this;
			//console.log($(this).offset().top)
			var href = "#" + $(this).attr('id') ;
			$.scope.sidebarList.push({
				href: href,
				name: $(this).html()
			});
		}
		var sideWidth = $( '#sidebar' ).width();
	});
	
	//
	/*$( '.list-group' ).waypoint( 'sticky', {
		wrapper: '<div class="sticky-wrapper" />',
		stuckClass: 'stuck',
		offset: 20,
		width: sideWidth
	});*/

	
	$jq.__currentPage.unloadEvent = function(){

		//clean repeats after page change event
		delete $.scope.myRepeat;
		delete $.scope.sidebarList;
	};

	$( ".docExample" ).each( function () {
		if(true){
			$(this).addClass('doc');
			$(this).wrap(function(){
				//apply template
				render = ich.docTemplate({
					source: htmlspecialchars($(this).html())
				});

				return render;
			});

			//$parent = $(this).parent();
		}
	} );

	$('.docSwitch button').on('click', function(){
		var $parents = $(this).parents('div.docDiv')
		console.log( $parents )
		$parents.find( '.doc' ).hide()
		$parents.find( '.' + $(this).data('type') ).show()
		//$(  ).show();
		//alert($(this).data('type'))
	} );
	//$( '.list-group-item' ).width( sideWidth );

});
</script>